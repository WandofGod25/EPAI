# EPAI Penetration Testing Security Configuration

## Security Settings
```json
{
  "api_key_settings": {
    "format": "epai_[base64_random_bytes]",
    "hashing_algorithm": "bcrypt/sha256",
    "expiration_days": 30,
    "rotation_required": true
  },
  "rate_limits": {
    "default_ip_limit": 30,
    "default_api_key_limit": 120,
    "pentest_endpoint_ip_limit": 100,
    "pentest_endpoint_api_key_limit": 500
  },
  "security_headers": {
    "Content-Security-Policy": "default-src 'self'",
    "X-Frame-Options": "DENY",
    "X-XSS-Protection": "1; mode=block",
    "Strict-Transport-Security": "max-age=31536000; includeSubDomains"
  },
  "data_retention": {
    "logs_days": 90,
    "security_events_days": 365,
    "ingestion_events_days": 730,
    "insights_days": 730,
    "pentest_logs_days": 7
  },
  "pentest_mode": true,
  "detailed_logging": true
}
```

## Data Retention
- Regular logs retention period: 90 days
- Security events retention period: 365 days
- Ingestion events retention period: 730 days
- Insights retention period: 730 days

## Rate Limiting
- Default IP-based rate limit: 30 requests/minute
- Default API key-based rate limit: 120 requests/minute
- Penetration testing endpoint IP limit: 100 requests/minute
- Penetration testing endpoint API key limit: 500 requests/minute

## Security Event Logging
- Security events will be logged to the `security_events` table
- A 'pentest.started' event will be logged to mark the beginning of testing

## API Key Security
- API keys should be stored as hashes in the database
- API keys should expire after 30 days by default
- API keys should be validated using a secure validation function
- API key usage should be logged for security audit

## Security Headers
- Content-Security-Policy: default-src 'self'
- X-Frame-Options: DENY
- X-XSS-Protection: 1; mode=block
- Strict-Transport-Security: max-age=31536000; includeSubDomains